<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>X Trade - Crypto Trading Dashboard</title>
  <!-- Tailwind CSS via CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Chart.js via CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <!-- Time adapter for Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
  <style>
    /* Hide scrollbar for horizontal crypto list */
    .no-scrollbar::-webkit-scrollbar { display: none; }
    .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    .smooth-scroll { scroll-behavior: smooth; }
  </style>
</head>
<body class="bg-gray-900 text-white font-sans">

  <!-- Header -->
  <header class="bg-gray-800 border-b border-gray-700 p-4 sticky top-0 z-50 flex justify-between items-center">
    <div class="flex items-center space-x-2">
      <div class="w-10 h-10 bg-white text-black rounded-full flex items-center justify-center font-bold text-xl">X</div>
      <span class="text-xl font-bold">X Trade</span>
    </div>
    <div id="balance" class="text-lg font-semibold">Balance: $10,000</div>
  </header>

  <!-- Main Content -->
  <main class="px-4 py-4">
    <!-- Trading Chart -->
    <div class="bg-gray-800 p-4 rounded-lg shadow-lg max-w-xl mx-auto">
      <h2 id="chartTitle" class="text-center text-xl font-semibold mb-2">BTC Price</h2>
      <canvas id="tradingChart" class="w-full h-64"></canvas>
    </div>

    <!-- Crypto Card List -->
    <div class="mt-6 overflow-x-auto no-scrollbar smooth-scroll">
      <div id="cryptoList" class="flex space-x-4">
        <!-- Crypto cards injected by JavaScript -->
      </div>
    </div>
  </main>

  <!-- Fixed Buy & Sell Buttons -->
  <div class="fixed bottom-4 left-1/2 transform -translate-x-1/2 flex space-x-4 z-50">
    <button onclick="openTradeModal('buy')" class="bg-green-600 hover:bg-green-700 px-6 py-3 rounded-lg font-bold">Buy</button>
    <button onclick="openTradeModal('sell')" class="bg-red-600 hover:bg-red-700 px-6 py-3 rounded-lg font-bold">Sell</button>
  </div>

  <!-- Trade Modal -->
  <div id="tradeModal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center">
    <div class="bg-gray-800 p-6 rounded-lg w-11/12 max-w-md relative">
      <button onclick="closeTradeModal()" class="absolute top-2 right-2 text-2xl font-bold">&times;</button>
      <h2 id="modalTitle" class="text-xl font-semibold mb-4">Transaction</h2>
      <input type="text" id="txnName" placeholder="Your Name" class="w-full p-3 mb-3 rounded bg-gray-700 placeholder-gray-400" />
      <input type="text" id="txnPhone" placeholder="Phone Number" class="w-full p-3 mb-3 rounded bg-gray-700 placeholder-gray-400" />
      <input type="number" id="txnAmount" placeholder="Amount ($)" class="w-full p-3 mb-3 rounded bg-gray-700 placeholder-gray-400" />
      <select id="txnMethod" class="w-full p-3 mb-4 rounded bg-gray-700">
        <option value="Card">Card</option>
        <option value="Easypaisa">EasyPaisa</option>
        <option value="JazzCash">JazzCash</option>
      </select>
      <button onclick="submitTrade()" class="w-full bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 rounded-lg">Confirm</button>
    </div>
  </div>

  <!-- JavaScript -->
  <script>
    // Global variables
    let balance = 10000;
    let selectedCrypto = "BTC";
    let prevChartPrice = null;
    
    // Simulated crypto base prices for demonstration
    const cryptoPrices = {
      BTC: 50000,
      ETH: 3500,
      XRP: 1.2,
      LTC: 180,
      ADA: 1.5,
      DOT: 30,
      DOGE: 0.25,
      SOL: 120,
      BNB: 400
    };

    // Update balance display
    function updateBalanceDisplay() {
      document.getElementById("balance").innerText = `Balance: $${balance.toFixed(2)}`;
    }
    updateBalanceDisplay();

    // Chart.js Setup with Gradient Fill & Time Scale
    const ctx = document.getElementById("tradingChart").getContext("2d");
    const gradientGreen = ctx.createLinearGradient(0, 0, 0, 300);
    gradientGreen.addColorStop(0, "rgba(0,255,0,0.4)");
    gradientGreen.addColorStop(1, "rgba(0,0,0,0)");
    const gradientRed = ctx.createLinearGradient(0, 0, 0, 300);
    gradientRed.addColorStop(0, "rgba(255,0,0,0.4)");
    gradientRed.addColorStop(1, "rgba(0,0,0,0)");

    const tradingChart = new Chart(ctx, {
      type: "line",
      data: {
        labels: [],
        datasets: [{
          label: selectedCrypto + " Price",
          data: [],
          borderColor: "green",
          backgroundColor: gradientGreen,
          borderWidth: 2,
          pointRadius: 0,
          tension: 0.2
        }]
      },
      options: {
        responsive: true,
        animation: { duration: 800, easing: "easeInOutQuad" },
        scales: {
          x: {
            type: "time",
            time: { unit: "second", tooltipFormat: "HH:mm:ss" },
            grid: { color: "rgba(255,255,255,0.1)" },
            ticks: { color: "#aaa" }
          },
          y: {
            grid: { color: "rgba(255,255,255,0.1)" },
            ticks: { color: "#aaa" }
          }
        },
        plugins: {
          tooltip: { mode: "index", intersect: false }
        },
        interaction: { mode: "nearest", axis: "x", intersect: false }
      }
    });

    // Update chart with simulated data for selected crypto
    function updateChart() {
      let min = 10000, max = 60000;
      switch(selectedCrypto) {
        case "BTC": min = 10000; max = 60000; break;
        case "ETH": min = 500; max = 4000; break;
        case "XRP": min = 0.5; max = 3; break;
        case "LTC": min = 50; max = 400; break;
        case "ADA": min = 0.5; max = 5; break;
        case "DOT": min = 2; max = 40; break;
        case "DOGE": min = 0.01; max = 1; break;
        case "SOL": min = 10; max = 300; break;
        case "BNB": min = 100; max = 700; break;
      }
      let newPrice = (Math.random() * (max - min) + min).toFixed(2);
      if (prevChartPrice !== null) {
        if (newPrice > prevChartPrice) {
          tradingChart.data.datasets[0].borderColor = "green";
          tradingChart.data.datasets[0].backgroundColor = gradientGreen;
        } else {
          tradingChart.data.datasets[0].borderColor = "red";
          tradingChart.data.datasets[0].backgroundColor = gradientRed;
        }
      }
      tradingChart.data.labels.push(new Date());
      tradingChart.data.datasets[0].data.push(newPrice);
      if (tradingChart.data.labels.length > 20) {
        tradingChart.data.labels.shift();
        tradingChart.data.datasets[0].data.shift();
      }
      tradingChart.update();
      prevChartPrice = newPrice;
    }
    setInterval(updateChart, 5000);

    // Update crypto card list with simulated prices and directional signals
    const cryptoList = document.getElementById("cryptoList");
    const cryptoSymbols = Object.keys(cryptoPrices);
    function updateCryptoCards() {
      cryptoList.innerHTML = "";
      cryptoSymbols.forEach(symbol => {
        let basePrice = cryptoPrices[symbol];
        let price = (Math.random() * (basePrice * 0.1) + basePrice).toFixed(2);
        let change = (Math.random() - 0.5) * 10;
        let color = change >= 0 ? "green" : "red";
        let arrow = change >= 0 ? "▲" : "▼";
        let card = document.createElement("div");
        card.className = "p-3 bg-gray-800 rounded-lg text-center w-32 cursor-pointer hover:bg-gray-700 transition-colors";
        card.innerHTML = `<p class="font-semibold">${symbol}</p>
                          <p class="text-sm text-${color}-500">${arrow} $${price}</p>`;
        card.onclick = () => { selectCrypto(symbol); };
        cryptoList.appendChild(card);
      });
    }
    updateCryptoCards();
    setInterval(updateCryptoCards, 5000);

    // When a crypto card is clicked, update chart for that crypto
    function selectCrypto(symbol) {
      selectedCrypto = symbol;
      prevChartPrice = null;
      tradingChart.data.datasets[0].label = symbol + " Price";
      document.getElementById("chartTitle").innerText = symbol + " Price";
      tradingChart.data.labels = [];
      tradingChart.data.datasets[0].data = [];
      tradingChart.update();
    }

    // Auto-scroll crypto cards smoothly
    setInterval(() => {
      cryptoList.scrollBy({ left: 2, behavior: "smooth" });
    }, 100);

    // Trade Modal Functions
    function openTradeModal(type) {
      document.getElementById("modalTitle").innerText = type === "buy" ? "Buy Crypto" : "Sell Crypto";
      document.getElementById("tradeModal").dataset.type = type;
      document.getElementById("tradeModal").classList.remove("hidden");
    }
    function closeTradeModal() {
      document.getElementById("tradeModal").classList.add("hidden");
    }
    function submitTrade() {
      let type = document.getElementById("tradeModal").dataset.type;
      let amount = parseFloat(document.getElementById("txnAmount").value);
      if (isNaN(amount) || amount <= 0) {
        alert("Enter a valid amount");
        return;
      }
      if (type === "buy" && amount > balance) {
        alert("Insufficient balance!");
        return;
      }
      balance += type === "buy" ? -amount : amount;
      updateBalanceDisplay();
      alert(type === "buy" ? "Purchase Successful!" : "Sale Successful!");
      document.getElementById("txnName").value = "";
      document.getElementById("txnPhone").value = "";
      document.getElementById("txnAmount").value = "";
      closeTradeModal();
    }
  </script>
</body>
</html>
